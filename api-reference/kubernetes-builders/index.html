<!doctype html><html lang=en-us dir=ltr itemscope itemtype=http://schema.org/Article data-r-output-format=html><head><meta charset=utf-8><meta name=viewport content="height=device-height,width=device-width,initial-scale=1,minimum-scale=1"><meta name=generator content="Hugo 0.155.3"><meta name=generator content="Relearn 8.0.0+9803d5122ebb3276acea823f476e9eb44f607862"><meta name=description content='Kubernetes Builders - Core Resource Helpers The kubernetes package provides GVK utilities, scheme registration, and strongly-typed builder functions for core Kubernetes resources.
Overview This package exposes helpers that other Kure packages (and external consumers such as Crane) use to construct and inspect Kubernetes objects without dealing with low-level struct details.
Import import "github.com/go-kure/kure/pkg/kubernetes" GVK Utilities // Resolve the GVK of any registered runtime.Object gvk, err := kubernetes.GetGroupVersionKind(myDeployment) // Check if a GVK is in an allow list ok := kubernetes.IsGVKAllowed(gvk, allowedGVKs) Scheme Registration // Lazily registers all supported API groups (core K8s, FluxCD, cert-manager, etc.) err := kubernetes.RegisterSchemes() HPA Builders // Create a HorizontalPodAutoscaler hpa := kubernetes.CreateHorizontalPodAutoscaler("my-app", "default") // Set the scale target err := kubernetes.SetHPAScaleTargetRef(hpa, "apps/v1", "Deployment", "my-app") // Set replica bounds err = kubernetes.SetHPAMinMaxReplicas(hpa, 2, 10) // Add CPU and memory metrics err = kubernetes.AddHPACPUMetric(hpa, 80) err = kubernetes.AddHPAMemoryMetric(hpa, 70) // Set scaling behavior window := int32(300) err = kubernetes.SetHPABehavior(hpa, &amp;autoscalingv2.HorizontalPodAutoscalerBehavior{ ScaleDown: &amp;autoscalingv2.HPAScalingRules{ StabilizationWindowSeconds: &amp;window, }, }) // Update metadata err = kubernetes.SetHPALabels(hpa, map[string]string{"env": "prod"}) err = kubernetes.SetHPAAnnotations(hpa, map[string]string{"owner": "platform"}) PDB Builders // Create a PodDisruptionBudget pdb := kubernetes.CreatePodDisruptionBudget("my-app", "default") // Set disruption budget (MinAvailable and MaxUnavailable are mutually exclusive) err := kubernetes.SetPDBMinAvailable(pdb, intstr.FromInt32(2)) // or: err = kubernetes.SetPDBMaxUnavailable(pdb, intstr.FromString("25%")) // Set the label selector err = kubernetes.SetPDBSelector(pdb, &amp;metav1.LabelSelector{ MatchLabels: map[string]string{"app": "my-app"}, }) // Update metadata err = kubernetes.SetPDBLabels(pdb, map[string]string{"env": "prod"}) err = kubernetes.SetPDBAnnotations(pdb, map[string]string{"owner": "platform"}) Deployment Builders // Create a Deployment dep := kubernetes.CreateDeployment("my-app", "default") // Add a container container := &amp;corev1.Container{Name: "app", Image: "nginx:1.25"} err := kubernetes.AddDeploymentContainer(dep, container) // Set replicas and strategy err = kubernetes.SetDeploymentReplicas(dep, 3) err = kubernetes.SetDeploymentStrategy(dep, appsv1.DeploymentStrategy{ Type: appsv1.RollingUpdateDeploymentStrategyType, }) // Configure pod template err = kubernetes.SetDeploymentServiceAccountName(dep, "my-sa") err = kubernetes.SetDeploymentNodeSelector(dep, map[string]string{"role": "web"}) err = kubernetes.AddDeploymentToleration(dep, &amp;corev1.Toleration{Key: "dedicated", Value: "web"}) CronJob Builders // Create a CronJob cj := kubernetes.CreateCronJob("my-job", "default", "*/5 * * * *") // Add a container container := &amp;corev1.Container{Name: "worker", Image: "busybox:1.36"} err := kubernetes.AddCronJobContainer(cj, container) // Configure schedule and policies err = kubernetes.SetCronJobConcurrencyPolicy(cj, batchv1.ForbidConcurrent) err = kubernetes.SetCronJobSuccessfulJobsHistoryLimit(cj, 3) err = kubernetes.SetCronJobFailedJobsHistoryLimit(cj, 1) // Configure pod template err = kubernetes.SetCronJobServiceAccountName(cj, "my-sa") err = kubernetes.SetCronJobNodeSelector(cj, map[string]string{"role": "batch"}) err = kubernetes.AddCronJobToleration(cj, &amp;corev1.Toleration{Key: "dedicated", Value: "batch"}) Service Builders // Create a Service svc := kubernetes.CreateService("my-app", "default") // Configure the service err := kubernetes.SetServiceSelector(svc, map[string]string{"app": "my-app"}) err = kubernetes.AddServicePort(svc, corev1.ServicePort{ Name: "http", Port: 80, TargetPort: intstr.FromInt32(8080), }) err = kubernetes.SetServiceType(svc, corev1.ServiceTypeLoadBalancer) // Update metadata err = kubernetes.AddServiceLabel(svc, "env", "prod") err = kubernetes.AddServiceAnnotation(svc, "external-dns.alpha.kubernetes.io/hostname", "app.example.com") Ingress Builders // Create an Ingress ing := kubernetes.CreateIngress("my-app", "default", "nginx") // Build a rule with paths rule := kubernetes.CreateIngressRule("app.example.com") pt := netv1.PathTypePrefix path := kubernetes.CreateIngressPath("/", &amp;pt, "my-app", "http") kubernetes.AddIngressRulePath(rule, path) err := kubernetes.AddIngressRule(ing, rule) // Add TLS err = kubernetes.AddIngressTLS(ing, netv1.IngressTLS{ Hosts: []string{"app.example.com"}, SecretName: "my-app-tls", }) Related Packages fluxcd - FluxCD resource constructors errors - Structured error types used for nil-check sentinels'><meta name=author content><meta name=twitter:card content="summary"><meta name=twitter:title content="Kubernetes Builders :: Go Kure"><meta name=twitter:description content='Kubernetes Builders - Core Resource Helpers The kubernetes package provides GVK utilities, scheme registration, and strongly-typed builder functions for core Kubernetes resources.
Overview This package exposes helpers that other Kure packages (and external consumers such as Crane) use to construct and inspect Kubernetes objects without dealing with low-level struct details.
Import import "github.com/go-kure/kure/pkg/kubernetes" GVK Utilities // Resolve the GVK of any registered runtime.Object gvk, err := kubernetes.GetGroupVersionKind(myDeployment) // Check if a GVK is in an allow list ok := kubernetes.IsGVKAllowed(gvk, allowedGVKs) Scheme Registration // Lazily registers all supported API groups (core K8s, FluxCD, cert-manager, etc.) err := kubernetes.RegisterSchemes() HPA Builders // Create a HorizontalPodAutoscaler hpa := kubernetes.CreateHorizontalPodAutoscaler("my-app", "default") // Set the scale target err := kubernetes.SetHPAScaleTargetRef(hpa, "apps/v1", "Deployment", "my-app") // Set replica bounds err = kubernetes.SetHPAMinMaxReplicas(hpa, 2, 10) // Add CPU and memory metrics err = kubernetes.AddHPACPUMetric(hpa, 80) err = kubernetes.AddHPAMemoryMetric(hpa, 70) // Set scaling behavior window := int32(300) err = kubernetes.SetHPABehavior(hpa, &amp;autoscalingv2.HorizontalPodAutoscalerBehavior{ ScaleDown: &amp;autoscalingv2.HPAScalingRules{ StabilizationWindowSeconds: &amp;window, }, }) // Update metadata err = kubernetes.SetHPALabels(hpa, map[string]string{"env": "prod"}) err = kubernetes.SetHPAAnnotations(hpa, map[string]string{"owner": "platform"}) PDB Builders // Create a PodDisruptionBudget pdb := kubernetes.CreatePodDisruptionBudget("my-app", "default") // Set disruption budget (MinAvailable and MaxUnavailable are mutually exclusive) err := kubernetes.SetPDBMinAvailable(pdb, intstr.FromInt32(2)) // or: err = kubernetes.SetPDBMaxUnavailable(pdb, intstr.FromString("25%")) // Set the label selector err = kubernetes.SetPDBSelector(pdb, &amp;metav1.LabelSelector{ MatchLabels: map[string]string{"app": "my-app"}, }) // Update metadata err = kubernetes.SetPDBLabels(pdb, map[string]string{"env": "prod"}) err = kubernetes.SetPDBAnnotations(pdb, map[string]string{"owner": "platform"}) Deployment Builders // Create a Deployment dep := kubernetes.CreateDeployment("my-app", "default") // Add a container container := &amp;corev1.Container{Name: "app", Image: "nginx:1.25"} err := kubernetes.AddDeploymentContainer(dep, container) // Set replicas and strategy err = kubernetes.SetDeploymentReplicas(dep, 3) err = kubernetes.SetDeploymentStrategy(dep, appsv1.DeploymentStrategy{ Type: appsv1.RollingUpdateDeploymentStrategyType, }) // Configure pod template err = kubernetes.SetDeploymentServiceAccountName(dep, "my-sa") err = kubernetes.SetDeploymentNodeSelector(dep, map[string]string{"role": "web"}) err = kubernetes.AddDeploymentToleration(dep, &amp;corev1.Toleration{Key: "dedicated", Value: "web"}) CronJob Builders // Create a CronJob cj := kubernetes.CreateCronJob("my-job", "default", "*/5 * * * *") // Add a container container := &amp;corev1.Container{Name: "worker", Image: "busybox:1.36"} err := kubernetes.AddCronJobContainer(cj, container) // Configure schedule and policies err = kubernetes.SetCronJobConcurrencyPolicy(cj, batchv1.ForbidConcurrent) err = kubernetes.SetCronJobSuccessfulJobsHistoryLimit(cj, 3) err = kubernetes.SetCronJobFailedJobsHistoryLimit(cj, 1) // Configure pod template err = kubernetes.SetCronJobServiceAccountName(cj, "my-sa") err = kubernetes.SetCronJobNodeSelector(cj, map[string]string{"role": "batch"}) err = kubernetes.AddCronJobToleration(cj, &amp;corev1.Toleration{Key: "dedicated", Value: "batch"}) Service Builders // Create a Service svc := kubernetes.CreateService("my-app", "default") // Configure the service err := kubernetes.SetServiceSelector(svc, map[string]string{"app": "my-app"}) err = kubernetes.AddServicePort(svc, corev1.ServicePort{ Name: "http", Port: 80, TargetPort: intstr.FromInt32(8080), }) err = kubernetes.SetServiceType(svc, corev1.ServiceTypeLoadBalancer) // Update metadata err = kubernetes.AddServiceLabel(svc, "env", "prod") err = kubernetes.AddServiceAnnotation(svc, "external-dns.alpha.kubernetes.io/hostname", "app.example.com") Ingress Builders // Create an Ingress ing := kubernetes.CreateIngress("my-app", "default", "nginx") // Build a rule with paths rule := kubernetes.CreateIngressRule("app.example.com") pt := netv1.PathTypePrefix path := kubernetes.CreateIngressPath("/", &amp;pt, "my-app", "http") kubernetes.AddIngressRulePath(rule, path) err := kubernetes.AddIngressRule(ing, rule) // Add TLS err = kubernetes.AddIngressTLS(ing, netv1.IngressTLS{ Hosts: []string{"app.example.com"}, SecretName: "my-app-tls", }) Related Packages fluxcd - FluxCD resource constructors errors - Structured error types used for nil-check sentinels'><meta property="og:url" content="https://www.gokure.dev/api-reference/kubernetes-builders/index.html"><meta property="og:site_name" content="Go Kure"><meta property="og:title" content="Kubernetes Builders :: Go Kure"><meta property="og:description" content='Kubernetes Builders - Core Resource Helpers The kubernetes package provides GVK utilities, scheme registration, and strongly-typed builder functions for core Kubernetes resources.
Overview This package exposes helpers that other Kure packages (and external consumers such as Crane) use to construct and inspect Kubernetes objects without dealing with low-level struct details.
Import import "github.com/go-kure/kure/pkg/kubernetes" GVK Utilities // Resolve the GVK of any registered runtime.Object gvk, err := kubernetes.GetGroupVersionKind(myDeployment) // Check if a GVK is in an allow list ok := kubernetes.IsGVKAllowed(gvk, allowedGVKs) Scheme Registration // Lazily registers all supported API groups (core K8s, FluxCD, cert-manager, etc.) err := kubernetes.RegisterSchemes() HPA Builders // Create a HorizontalPodAutoscaler hpa := kubernetes.CreateHorizontalPodAutoscaler("my-app", "default") // Set the scale target err := kubernetes.SetHPAScaleTargetRef(hpa, "apps/v1", "Deployment", "my-app") // Set replica bounds err = kubernetes.SetHPAMinMaxReplicas(hpa, 2, 10) // Add CPU and memory metrics err = kubernetes.AddHPACPUMetric(hpa, 80) err = kubernetes.AddHPAMemoryMetric(hpa, 70) // Set scaling behavior window := int32(300) err = kubernetes.SetHPABehavior(hpa, &amp;autoscalingv2.HorizontalPodAutoscalerBehavior{ ScaleDown: &amp;autoscalingv2.HPAScalingRules{ StabilizationWindowSeconds: &amp;window, }, }) // Update metadata err = kubernetes.SetHPALabels(hpa, map[string]string{"env": "prod"}) err = kubernetes.SetHPAAnnotations(hpa, map[string]string{"owner": "platform"}) PDB Builders // Create a PodDisruptionBudget pdb := kubernetes.CreatePodDisruptionBudget("my-app", "default") // Set disruption budget (MinAvailable and MaxUnavailable are mutually exclusive) err := kubernetes.SetPDBMinAvailable(pdb, intstr.FromInt32(2)) // or: err = kubernetes.SetPDBMaxUnavailable(pdb, intstr.FromString("25%")) // Set the label selector err = kubernetes.SetPDBSelector(pdb, &amp;metav1.LabelSelector{ MatchLabels: map[string]string{"app": "my-app"}, }) // Update metadata err = kubernetes.SetPDBLabels(pdb, map[string]string{"env": "prod"}) err = kubernetes.SetPDBAnnotations(pdb, map[string]string{"owner": "platform"}) Deployment Builders // Create a Deployment dep := kubernetes.CreateDeployment("my-app", "default") // Add a container container := &amp;corev1.Container{Name: "app", Image: "nginx:1.25"} err := kubernetes.AddDeploymentContainer(dep, container) // Set replicas and strategy err = kubernetes.SetDeploymentReplicas(dep, 3) err = kubernetes.SetDeploymentStrategy(dep, appsv1.DeploymentStrategy{ Type: appsv1.RollingUpdateDeploymentStrategyType, }) // Configure pod template err = kubernetes.SetDeploymentServiceAccountName(dep, "my-sa") err = kubernetes.SetDeploymentNodeSelector(dep, map[string]string{"role": "web"}) err = kubernetes.AddDeploymentToleration(dep, &amp;corev1.Toleration{Key: "dedicated", Value: "web"}) CronJob Builders // Create a CronJob cj := kubernetes.CreateCronJob("my-job", "default", "*/5 * * * *") // Add a container container := &amp;corev1.Container{Name: "worker", Image: "busybox:1.36"} err := kubernetes.AddCronJobContainer(cj, container) // Configure schedule and policies err = kubernetes.SetCronJobConcurrencyPolicy(cj, batchv1.ForbidConcurrent) err = kubernetes.SetCronJobSuccessfulJobsHistoryLimit(cj, 3) err = kubernetes.SetCronJobFailedJobsHistoryLimit(cj, 1) // Configure pod template err = kubernetes.SetCronJobServiceAccountName(cj, "my-sa") err = kubernetes.SetCronJobNodeSelector(cj, map[string]string{"role": "batch"}) err = kubernetes.AddCronJobToleration(cj, &amp;corev1.Toleration{Key: "dedicated", Value: "batch"}) Service Builders // Create a Service svc := kubernetes.CreateService("my-app", "default") // Configure the service err := kubernetes.SetServiceSelector(svc, map[string]string{"app": "my-app"}) err = kubernetes.AddServicePort(svc, corev1.ServicePort{ Name: "http", Port: 80, TargetPort: intstr.FromInt32(8080), }) err = kubernetes.SetServiceType(svc, corev1.ServiceTypeLoadBalancer) // Update metadata err = kubernetes.AddServiceLabel(svc, "env", "prod") err = kubernetes.AddServiceAnnotation(svc, "external-dns.alpha.kubernetes.io/hostname", "app.example.com") Ingress Builders // Create an Ingress ing := kubernetes.CreateIngress("my-app", "default", "nginx") // Build a rule with paths rule := kubernetes.CreateIngressRule("app.example.com") pt := netv1.PathTypePrefix path := kubernetes.CreateIngressPath("/", &amp;pt, "my-app", "http") kubernetes.AddIngressRulePath(rule, path) err := kubernetes.AddIngressRule(ing, rule) // Add TLS err = kubernetes.AddIngressTLS(ing, netv1.IngressTLS{ Hosts: []string{"app.example.com"}, SecretName: "my-app-tls", }) Related Packages fluxcd - FluxCD resource constructors errors - Structured error types used for nil-check sentinels'><meta property="og:locale" content="en_us"><meta property="og:type" content="article"><meta property="article:section" content="API Reference"><meta itemprop=name content="Kubernetes Builders :: Go Kure"><meta itemprop=description content='Kubernetes Builders - Core Resource Helpers The kubernetes package provides GVK utilities, scheme registration, and strongly-typed builder functions for core Kubernetes resources.
Overview This package exposes helpers that other Kure packages (and external consumers such as Crane) use to construct and inspect Kubernetes objects without dealing with low-level struct details.
Import import "github.com/go-kure/kure/pkg/kubernetes" GVK Utilities // Resolve the GVK of any registered runtime.Object gvk, err := kubernetes.GetGroupVersionKind(myDeployment) // Check if a GVK is in an allow list ok := kubernetes.IsGVKAllowed(gvk, allowedGVKs) Scheme Registration // Lazily registers all supported API groups (core K8s, FluxCD, cert-manager, etc.) err := kubernetes.RegisterSchemes() HPA Builders // Create a HorizontalPodAutoscaler hpa := kubernetes.CreateHorizontalPodAutoscaler("my-app", "default") // Set the scale target err := kubernetes.SetHPAScaleTargetRef(hpa, "apps/v1", "Deployment", "my-app") // Set replica bounds err = kubernetes.SetHPAMinMaxReplicas(hpa, 2, 10) // Add CPU and memory metrics err = kubernetes.AddHPACPUMetric(hpa, 80) err = kubernetes.AddHPAMemoryMetric(hpa, 70) // Set scaling behavior window := int32(300) err = kubernetes.SetHPABehavior(hpa, &amp;autoscalingv2.HorizontalPodAutoscalerBehavior{ ScaleDown: &amp;autoscalingv2.HPAScalingRules{ StabilizationWindowSeconds: &amp;window, }, }) // Update metadata err = kubernetes.SetHPALabels(hpa, map[string]string{"env": "prod"}) err = kubernetes.SetHPAAnnotations(hpa, map[string]string{"owner": "platform"}) PDB Builders // Create a PodDisruptionBudget pdb := kubernetes.CreatePodDisruptionBudget("my-app", "default") // Set disruption budget (MinAvailable and MaxUnavailable are mutually exclusive) err := kubernetes.SetPDBMinAvailable(pdb, intstr.FromInt32(2)) // or: err = kubernetes.SetPDBMaxUnavailable(pdb, intstr.FromString("25%")) // Set the label selector err = kubernetes.SetPDBSelector(pdb, &amp;metav1.LabelSelector{ MatchLabels: map[string]string{"app": "my-app"}, }) // Update metadata err = kubernetes.SetPDBLabels(pdb, map[string]string{"env": "prod"}) err = kubernetes.SetPDBAnnotations(pdb, map[string]string{"owner": "platform"}) Deployment Builders // Create a Deployment dep := kubernetes.CreateDeployment("my-app", "default") // Add a container container := &amp;corev1.Container{Name: "app", Image: "nginx:1.25"} err := kubernetes.AddDeploymentContainer(dep, container) // Set replicas and strategy err = kubernetes.SetDeploymentReplicas(dep, 3) err = kubernetes.SetDeploymentStrategy(dep, appsv1.DeploymentStrategy{ Type: appsv1.RollingUpdateDeploymentStrategyType, }) // Configure pod template err = kubernetes.SetDeploymentServiceAccountName(dep, "my-sa") err = kubernetes.SetDeploymentNodeSelector(dep, map[string]string{"role": "web"}) err = kubernetes.AddDeploymentToleration(dep, &amp;corev1.Toleration{Key: "dedicated", Value: "web"}) CronJob Builders // Create a CronJob cj := kubernetes.CreateCronJob("my-job", "default", "*/5 * * * *") // Add a container container := &amp;corev1.Container{Name: "worker", Image: "busybox:1.36"} err := kubernetes.AddCronJobContainer(cj, container) // Configure schedule and policies err = kubernetes.SetCronJobConcurrencyPolicy(cj, batchv1.ForbidConcurrent) err = kubernetes.SetCronJobSuccessfulJobsHistoryLimit(cj, 3) err = kubernetes.SetCronJobFailedJobsHistoryLimit(cj, 1) // Configure pod template err = kubernetes.SetCronJobServiceAccountName(cj, "my-sa") err = kubernetes.SetCronJobNodeSelector(cj, map[string]string{"role": "batch"}) err = kubernetes.AddCronJobToleration(cj, &amp;corev1.Toleration{Key: "dedicated", Value: "batch"}) Service Builders // Create a Service svc := kubernetes.CreateService("my-app", "default") // Configure the service err := kubernetes.SetServiceSelector(svc, map[string]string{"app": "my-app"}) err = kubernetes.AddServicePort(svc, corev1.ServicePort{ Name: "http", Port: 80, TargetPort: intstr.FromInt32(8080), }) err = kubernetes.SetServiceType(svc, corev1.ServiceTypeLoadBalancer) // Update metadata err = kubernetes.AddServiceLabel(svc, "env", "prod") err = kubernetes.AddServiceAnnotation(svc, "external-dns.alpha.kubernetes.io/hostname", "app.example.com") Ingress Builders // Create an Ingress ing := kubernetes.CreateIngress("my-app", "default", "nginx") // Build a rule with paths rule := kubernetes.CreateIngressRule("app.example.com") pt := netv1.PathTypePrefix path := kubernetes.CreateIngressPath("/", &amp;pt, "my-app", "http") kubernetes.AddIngressRulePath(rule, path) err := kubernetes.AddIngressRule(ing, rule) // Add TLS err = kubernetes.AddIngressTLS(ing, netv1.IngressTLS{ Hosts: []string{"app.example.com"}, SecretName: "my-app-tls", }) Related Packages fluxcd - FluxCD resource constructors errors - Structured error types used for nil-check sentinels'><meta itemprop=wordCount content="464"><title>Kubernetes Builders :: Go Kure</title><link href=/css/auto-complete/auto-complete.min.css?1771438027 rel=stylesheet><script src=/js/auto-complete/auto-complete.min.js?1771438027 defer></script><script src=/js/search-lunr.min.js?1771438027 defer></script><script src=/js/search.min.js?1771438027 defer></script><script>window.relearn=window.relearn||{},window.relearn.index_js_url="/searchindex.en.js?1771438027"</script><script src=/js/lunr/lunr.min.js?1771438027 defer></script><script src=/js/lunr/lunr.stemmer.support.min.js?1771438027 defer></script><script src=/js/lunr/lunr.multi.min.js?1771438027 defer></script><script src=/js/lunr/lunr.en.min.js?1771438027 defer></script><script>window.relearn=window.relearn||{},window.relearn.contentLangs=["en"]</script><link href=/fonts/fontawesome/css/fontawesome-all.min.css?1771438027 rel=stylesheet media=print onload='this.media="all",this.onload=null'><noscript><link href=/fonts/fontawesome/css/fontawesome-all.min.css?1771438027 rel=stylesheet></noscript><link href=/css/perfect-scrollbar/perfect-scrollbar.min.css?1771438027 rel=stylesheet><link href=/css/theme.min.css?1771438027 rel=stylesheet><link href=/css/format-html.min.css?1771438027 rel=stylesheet id=R-format-style><script>window.relearn=window.relearn||{},window.relearn.min=`.min`,window.relearn.path="/api-reference/kubernetes-builders/index.html",window.relearn.relBasePath="../..",window.relearn.relBaseUri="../..",window.relearn.absBaseUri="https://www.gokure.dev",window.relearn.disableAnchorCopy=!1,window.relearn.disableAnchorScrolling=!1,window.relearn.disableInlineCopyToClipboard=!0,window.relearn.enableBlockCodeWrap=!0,window.relearn.getItem=(e,t)=>e.getItem(t),window.relearn.setItem=(e,t,n)=>e.setItem(t,n),window.relearn.removeItem=(e,t)=>e.removeItem(t),window.T_Copy_to_clipboard=`Copy to clipboard`,window.T_Copied_to_clipboard=`Copied to clipboard!`,window.T_Copy_link_to_clipboard=`Copy link to clipboard`,window.T_Link_copied_to_clipboard=`Copied link to clipboard!`,window.T_Reset_view=`Reset view`,window.T_View_reset=`View reset!`,window.T_No_results_found=`No results found for "{0}"`,window.T_N_results_found=`{1} results found for "{0}"`,window.relearn.themevariants=["relearn-dark"],window.relearn.customvariantname="my-custom-variant",window.relearn.changeVariant=function(e){var t=document.documentElement.dataset.rThemeVariant;window.relearn.setItem(window.localStorage,window.relearn.absBaseUri+"/variant",e),document.documentElement.dataset.rThemeVariant=e,t!=e&&(document.dispatchEvent(new CustomEvent("themeVariantLoaded",{detail:{variant:e,oldVariant:t}})),window.relearn.markVariant())},window.relearn.markVariant=function(){var e=window.relearn.getItem(window.localStorage,window.relearn.absBaseUri+"/variant");document.querySelectorAll(".R-variantswitcher select").forEach(t=>{t.value=e})},window.relearn.initVariant=function(){var e=window.relearn.getItem(window.localStorage,window.relearn.absBaseUri+"/variant")??"";e==window.relearn.customvariantname||(!e||!window.relearn.themevariants.includes(e))&&(e=window.relearn.themevariants[0],window.relearn.setItem(window.localStorage,window.relearn.absBaseUri+"/variant",e)),document.documentElement.dataset.rThemeVariant=e},window.relearn.initVariant(),window.relearn.markVariant()</script><div class="notices warning" style=margin-bottom:1rem><div class=label>‚ö†Ô∏è Work in Progress</div><div class=content>Kure is currently under active development and has not been released yet. APIs and features are subject to change.</div></div></head><body class="mobile-support html" data-url=/api-reference/kubernetes-builders/index.html><div id=R-body class=default-animation><div id=R-body-overlay></div><nav id=R-topbar><div class=topbar-wrapper><div class=topbar-sidebar-divider></div><div class="topbar-area topbar-area-start" data-area=start><div class="topbar-button topbar-button-sidebar" data-content-empty=disable data-width-s=show data-width-m=hide data-width-l=hide><button class=topbar-control onclick=toggleNav() type=button title="Menu (CTRL+ALT+n)"><i class="fa-fw fas fa-bars"></i></button></div><div class="topbar-button topbar-button-toc" data-content-empty=hide data-width-s=show data-width-m=show data-width-l=show><button class=topbar-control onclick=toggleTopbarFlyout(this) type=button title="Table of Contents (CTRL+ALT+t)"><i class="fa-fw fas fa-list-alt"></i></button><div class=topbar-content><div class=topbar-content-wrapper><nav class=TableOfContents><ul><li><a href=#overview>Overview</a></li><li><a href=#import>Import</a></li><li><a href=#gvk-utilities>GVK Utilities</a></li><li><a href=#scheme-registration>Scheme Registration</a></li><li><a href=#hpa-builders>HPA Builders</a></li><li><a href=#pdb-builders>PDB Builders</a></li><li><a href=#deployment-builders>Deployment Builders</a></li><li><a href=#cronjob-builders>CronJob Builders</a></li><li><a href=#service-builders>Service Builders</a></li><li><a href=#ingress-builders>Ingress Builders</a></li><li><a href=#related-packages>Related Packages</a></li></ul></nav></div></div></div></div><ol class="topbar-breadcrumbs breadcrumbs highlightable" itemscope itemtype=http://schema.org/BreadcrumbList><li itemscope itemtype=https://schema.org/ListItem itemprop=itemListElement><a itemprop=item href=/index.html><span itemprop=name>Go Kure</span></a><meta itemprop=position content="1">&nbsp;>&nbsp;</li><li itemscope itemtype=https://schema.org/ListItem itemprop=itemListElement><a itemprop=item href=/api-reference/index.html><span itemprop=name>API Reference</span></a><meta itemprop=position content="2">&nbsp;>&nbsp;</li><li itemscope itemtype=https://schema.org/ListItem itemprop=itemListElement><span itemprop=name>Kubernetes Builders</span><meta itemprop=position content="3"></li></ol><div class="topbar-area topbar-area-end" data-area=end><div class="topbar-button topbar-button-prev" data-content-empty=disable data-width-s=show data-width-m=show data-width-l=show><a class=topbar-control href=/api-reference/cli/index.html title="CLI Utilities (ü°ê)"><i class="fa-fw fas fa-chevron-left"></i></a></div><div class="topbar-button topbar-button-next" data-content-empty=disable data-width-s=show data-width-m=show data-width-l=show><a class=topbar-control href=/api-reference/fluxcd-builders/index.html title="FluxCD Builders (ü°í)"><i class="fa-fw fas fa-chevron-right"></i></a></div><div class="topbar-button topbar-button-more" data-content-empty=hide data-width-s=show data-width-m=show data-width-l=show><button class=topbar-control onclick=toggleTopbarFlyout(this) type=button title=More><i class="fa-fw fas fa-ellipsis-v"></i></button><div class=topbar-content><div class=topbar-content-wrapper><div class="topbar-area topbar-area-more" data-area=more></div></div></div></div></div></div></nav><div id=R-main-overlay></div><main id=R-body-inner class="highlightable api-reference" tabindex=-1><div class=flex-block-wrapper><article class=default><header class=headline></header><h1 id=kubernetes-builders>Kubernetes Builders</h1><h1 id=kubernetes-builders---core-resource-helpers>Kubernetes Builders - Core Resource Helpers</h1><p>The <code>kubernetes</code> package provides GVK utilities, scheme registration, and strongly-typed builder functions for core Kubernetes resources.</p><h2 id=overview>Overview</h2><p>This package exposes helpers that other Kure packages (and external consumers such as Crane) use to construct and inspect Kubernetes objects without dealing with low-level struct details.</p><h2 id=import>Import</h2><div class="highlight wrap-code" dir=auto><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#f92672>import</span> <span style=color:#e6db74>&#34;github.com/go-kure/kure/pkg/kubernetes&#34;</span></span></span></code></pre></div><h2 id=gvk-utilities>GVK Utilities</h2><div class="highlight wrap-code" dir=auto><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#75715e>// Resolve the GVK of any registered runtime.Object</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>gvk</span>, <span style=color:#a6e22e>err</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>kubernetes</span>.<span style=color:#a6e22e>GetGroupVersionKind</span>(<span style=color:#a6e22e>myDeployment</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// Check if a GVK is in an allow list</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>ok</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>kubernetes</span>.<span style=color:#a6e22e>IsGVKAllowed</span>(<span style=color:#a6e22e>gvk</span>, <span style=color:#a6e22e>allowedGVKs</span>)</span></span></code></pre></div><h2 id=scheme-registration>Scheme Registration</h2><div class="highlight wrap-code" dir=auto><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#75715e>// Lazily registers all supported API groups (core K8s, FluxCD, cert-manager, etc.)</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>err</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>kubernetes</span>.<span style=color:#a6e22e>RegisterSchemes</span>()</span></span></code></pre></div><h2 id=hpa-builders>HPA Builders</h2><div class="highlight wrap-code" dir=auto><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#75715e>// Create a HorizontalPodAutoscaler</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>hpa</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>kubernetes</span>.<span style=color:#a6e22e>CreateHorizontalPodAutoscaler</span>(<span style=color:#e6db74>&#34;my-app&#34;</span>, <span style=color:#e6db74>&#34;default&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// Set the scale target</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>err</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>kubernetes</span>.<span style=color:#a6e22e>SetHPAScaleTargetRef</span>(<span style=color:#a6e22e>hpa</span>, <span style=color:#e6db74>&#34;apps/v1&#34;</span>, <span style=color:#e6db74>&#34;Deployment&#34;</span>, <span style=color:#e6db74>&#34;my-app&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// Set replica bounds</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>err</span> = <span style=color:#a6e22e>kubernetes</span>.<span style=color:#a6e22e>SetHPAMinMaxReplicas</span>(<span style=color:#a6e22e>hpa</span>, <span style=color:#ae81ff>2</span>, <span style=color:#ae81ff>10</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// Add CPU and memory metrics</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>err</span> = <span style=color:#a6e22e>kubernetes</span>.<span style=color:#a6e22e>AddHPACPUMetric</span>(<span style=color:#a6e22e>hpa</span>, <span style=color:#ae81ff>80</span>)
</span></span><span style=display:flex><span><span style=color:#a6e22e>err</span> = <span style=color:#a6e22e>kubernetes</span>.<span style=color:#a6e22e>AddHPAMemoryMetric</span>(<span style=color:#a6e22e>hpa</span>, <span style=color:#ae81ff>70</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// Set scaling behavior</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>window</span> <span style=color:#f92672>:=</span> int32(<span style=color:#ae81ff>300</span>)
</span></span><span style=display:flex><span><span style=color:#a6e22e>err</span> = <span style=color:#a6e22e>kubernetes</span>.<span style=color:#a6e22e>SetHPABehavior</span>(<span style=color:#a6e22e>hpa</span>, <span style=color:#f92672>&amp;</span><span style=color:#a6e22e>autoscalingv2</span>.<span style=color:#a6e22e>HorizontalPodAutoscalerBehavior</span>{
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>ScaleDown</span>: <span style=color:#f92672>&amp;</span><span style=color:#a6e22e>autoscalingv2</span>.<span style=color:#a6e22e>HPAScalingRules</span>{
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>StabilizationWindowSeconds</span>: <span style=color:#f92672>&amp;</span><span style=color:#a6e22e>window</span>,
</span></span><span style=display:flex><span>    },
</span></span><span style=display:flex><span>})
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// Update metadata</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>err</span> = <span style=color:#a6e22e>kubernetes</span>.<span style=color:#a6e22e>SetHPALabels</span>(<span style=color:#a6e22e>hpa</span>, <span style=color:#66d9ef>map</span>[<span style=color:#66d9ef>string</span>]<span style=color:#66d9ef>string</span>{<span style=color:#e6db74>&#34;env&#34;</span>: <span style=color:#e6db74>&#34;prod&#34;</span>})
</span></span><span style=display:flex><span><span style=color:#a6e22e>err</span> = <span style=color:#a6e22e>kubernetes</span>.<span style=color:#a6e22e>SetHPAAnnotations</span>(<span style=color:#a6e22e>hpa</span>, <span style=color:#66d9ef>map</span>[<span style=color:#66d9ef>string</span>]<span style=color:#66d9ef>string</span>{<span style=color:#e6db74>&#34;owner&#34;</span>: <span style=color:#e6db74>&#34;platform&#34;</span>})</span></span></code></pre></div><h2 id=pdb-builders>PDB Builders</h2><div class="highlight wrap-code" dir=auto><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#75715e>// Create a PodDisruptionBudget</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>pdb</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>kubernetes</span>.<span style=color:#a6e22e>CreatePodDisruptionBudget</span>(<span style=color:#e6db74>&#34;my-app&#34;</span>, <span style=color:#e6db74>&#34;default&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// Set disruption budget (MinAvailable and MaxUnavailable are mutually exclusive)</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>err</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>kubernetes</span>.<span style=color:#a6e22e>SetPDBMinAvailable</span>(<span style=color:#a6e22e>pdb</span>, <span style=color:#a6e22e>intstr</span>.<span style=color:#a6e22e>FromInt32</span>(<span style=color:#ae81ff>2</span>))
</span></span><span style=display:flex><span><span style=color:#75715e>// or: err = kubernetes.SetPDBMaxUnavailable(pdb, intstr.FromString(&#34;25%&#34;))</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// Set the label selector</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>err</span> = <span style=color:#a6e22e>kubernetes</span>.<span style=color:#a6e22e>SetPDBSelector</span>(<span style=color:#a6e22e>pdb</span>, <span style=color:#f92672>&amp;</span><span style=color:#a6e22e>metav1</span>.<span style=color:#a6e22e>LabelSelector</span>{
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>MatchLabels</span>: <span style=color:#66d9ef>map</span>[<span style=color:#66d9ef>string</span>]<span style=color:#66d9ef>string</span>{<span style=color:#e6db74>&#34;app&#34;</span>: <span style=color:#e6db74>&#34;my-app&#34;</span>},
</span></span><span style=display:flex><span>})
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// Update metadata</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>err</span> = <span style=color:#a6e22e>kubernetes</span>.<span style=color:#a6e22e>SetPDBLabels</span>(<span style=color:#a6e22e>pdb</span>, <span style=color:#66d9ef>map</span>[<span style=color:#66d9ef>string</span>]<span style=color:#66d9ef>string</span>{<span style=color:#e6db74>&#34;env&#34;</span>: <span style=color:#e6db74>&#34;prod&#34;</span>})
</span></span><span style=display:flex><span><span style=color:#a6e22e>err</span> = <span style=color:#a6e22e>kubernetes</span>.<span style=color:#a6e22e>SetPDBAnnotations</span>(<span style=color:#a6e22e>pdb</span>, <span style=color:#66d9ef>map</span>[<span style=color:#66d9ef>string</span>]<span style=color:#66d9ef>string</span>{<span style=color:#e6db74>&#34;owner&#34;</span>: <span style=color:#e6db74>&#34;platform&#34;</span>})</span></span></code></pre></div><h2 id=deployment-builders>Deployment Builders</h2><div class="highlight wrap-code" dir=auto><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#75715e>// Create a Deployment</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>dep</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>kubernetes</span>.<span style=color:#a6e22e>CreateDeployment</span>(<span style=color:#e6db74>&#34;my-app&#34;</span>, <span style=color:#e6db74>&#34;default&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// Add a container</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>container</span> <span style=color:#f92672>:=</span> <span style=color:#f92672>&amp;</span><span style=color:#a6e22e>corev1</span>.<span style=color:#a6e22e>Container</span>{<span style=color:#a6e22e>Name</span>: <span style=color:#e6db74>&#34;app&#34;</span>, <span style=color:#a6e22e>Image</span>: <span style=color:#e6db74>&#34;nginx:1.25&#34;</span>}
</span></span><span style=display:flex><span><span style=color:#a6e22e>err</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>kubernetes</span>.<span style=color:#a6e22e>AddDeploymentContainer</span>(<span style=color:#a6e22e>dep</span>, <span style=color:#a6e22e>container</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// Set replicas and strategy</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>err</span> = <span style=color:#a6e22e>kubernetes</span>.<span style=color:#a6e22e>SetDeploymentReplicas</span>(<span style=color:#a6e22e>dep</span>, <span style=color:#ae81ff>3</span>)
</span></span><span style=display:flex><span><span style=color:#a6e22e>err</span> = <span style=color:#a6e22e>kubernetes</span>.<span style=color:#a6e22e>SetDeploymentStrategy</span>(<span style=color:#a6e22e>dep</span>, <span style=color:#a6e22e>appsv1</span>.<span style=color:#a6e22e>DeploymentStrategy</span>{
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>Type</span>: <span style=color:#a6e22e>appsv1</span>.<span style=color:#a6e22e>RollingUpdateDeploymentStrategyType</span>,
</span></span><span style=display:flex><span>})
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// Configure pod template</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>err</span> = <span style=color:#a6e22e>kubernetes</span>.<span style=color:#a6e22e>SetDeploymentServiceAccountName</span>(<span style=color:#a6e22e>dep</span>, <span style=color:#e6db74>&#34;my-sa&#34;</span>)
</span></span><span style=display:flex><span><span style=color:#a6e22e>err</span> = <span style=color:#a6e22e>kubernetes</span>.<span style=color:#a6e22e>SetDeploymentNodeSelector</span>(<span style=color:#a6e22e>dep</span>, <span style=color:#66d9ef>map</span>[<span style=color:#66d9ef>string</span>]<span style=color:#66d9ef>string</span>{<span style=color:#e6db74>&#34;role&#34;</span>: <span style=color:#e6db74>&#34;web&#34;</span>})
</span></span><span style=display:flex><span><span style=color:#a6e22e>err</span> = <span style=color:#a6e22e>kubernetes</span>.<span style=color:#a6e22e>AddDeploymentToleration</span>(<span style=color:#a6e22e>dep</span>, <span style=color:#f92672>&amp;</span><span style=color:#a6e22e>corev1</span>.<span style=color:#a6e22e>Toleration</span>{<span style=color:#a6e22e>Key</span>: <span style=color:#e6db74>&#34;dedicated&#34;</span>, <span style=color:#a6e22e>Value</span>: <span style=color:#e6db74>&#34;web&#34;</span>})</span></span></code></pre></div><h2 id=cronjob-builders>CronJob Builders</h2><div class="highlight wrap-code" dir=auto><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#75715e>// Create a CronJob</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>cj</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>kubernetes</span>.<span style=color:#a6e22e>CreateCronJob</span>(<span style=color:#e6db74>&#34;my-job&#34;</span>, <span style=color:#e6db74>&#34;default&#34;</span>, <span style=color:#e6db74>&#34;*/5 * * * *&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// Add a container</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>container</span> <span style=color:#f92672>:=</span> <span style=color:#f92672>&amp;</span><span style=color:#a6e22e>corev1</span>.<span style=color:#a6e22e>Container</span>{<span style=color:#a6e22e>Name</span>: <span style=color:#e6db74>&#34;worker&#34;</span>, <span style=color:#a6e22e>Image</span>: <span style=color:#e6db74>&#34;busybox:1.36&#34;</span>}
</span></span><span style=display:flex><span><span style=color:#a6e22e>err</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>kubernetes</span>.<span style=color:#a6e22e>AddCronJobContainer</span>(<span style=color:#a6e22e>cj</span>, <span style=color:#a6e22e>container</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// Configure schedule and policies</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>err</span> = <span style=color:#a6e22e>kubernetes</span>.<span style=color:#a6e22e>SetCronJobConcurrencyPolicy</span>(<span style=color:#a6e22e>cj</span>, <span style=color:#a6e22e>batchv1</span>.<span style=color:#a6e22e>ForbidConcurrent</span>)
</span></span><span style=display:flex><span><span style=color:#a6e22e>err</span> = <span style=color:#a6e22e>kubernetes</span>.<span style=color:#a6e22e>SetCronJobSuccessfulJobsHistoryLimit</span>(<span style=color:#a6e22e>cj</span>, <span style=color:#ae81ff>3</span>)
</span></span><span style=display:flex><span><span style=color:#a6e22e>err</span> = <span style=color:#a6e22e>kubernetes</span>.<span style=color:#a6e22e>SetCronJobFailedJobsHistoryLimit</span>(<span style=color:#a6e22e>cj</span>, <span style=color:#ae81ff>1</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// Configure pod template</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>err</span> = <span style=color:#a6e22e>kubernetes</span>.<span style=color:#a6e22e>SetCronJobServiceAccountName</span>(<span style=color:#a6e22e>cj</span>, <span style=color:#e6db74>&#34;my-sa&#34;</span>)
</span></span><span style=display:flex><span><span style=color:#a6e22e>err</span> = <span style=color:#a6e22e>kubernetes</span>.<span style=color:#a6e22e>SetCronJobNodeSelector</span>(<span style=color:#a6e22e>cj</span>, <span style=color:#66d9ef>map</span>[<span style=color:#66d9ef>string</span>]<span style=color:#66d9ef>string</span>{<span style=color:#e6db74>&#34;role&#34;</span>: <span style=color:#e6db74>&#34;batch&#34;</span>})
</span></span><span style=display:flex><span><span style=color:#a6e22e>err</span> = <span style=color:#a6e22e>kubernetes</span>.<span style=color:#a6e22e>AddCronJobToleration</span>(<span style=color:#a6e22e>cj</span>, <span style=color:#f92672>&amp;</span><span style=color:#a6e22e>corev1</span>.<span style=color:#a6e22e>Toleration</span>{<span style=color:#a6e22e>Key</span>: <span style=color:#e6db74>&#34;dedicated&#34;</span>, <span style=color:#a6e22e>Value</span>: <span style=color:#e6db74>&#34;batch&#34;</span>})</span></span></code></pre></div><h2 id=service-builders>Service Builders</h2><div class="highlight wrap-code" dir=auto><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#75715e>// Create a Service</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>svc</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>kubernetes</span>.<span style=color:#a6e22e>CreateService</span>(<span style=color:#e6db74>&#34;my-app&#34;</span>, <span style=color:#e6db74>&#34;default&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// Configure the service</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>err</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>kubernetes</span>.<span style=color:#a6e22e>SetServiceSelector</span>(<span style=color:#a6e22e>svc</span>, <span style=color:#66d9ef>map</span>[<span style=color:#66d9ef>string</span>]<span style=color:#66d9ef>string</span>{<span style=color:#e6db74>&#34;app&#34;</span>: <span style=color:#e6db74>&#34;my-app&#34;</span>})
</span></span><span style=display:flex><span><span style=color:#a6e22e>err</span> = <span style=color:#a6e22e>kubernetes</span>.<span style=color:#a6e22e>AddServicePort</span>(<span style=color:#a6e22e>svc</span>, <span style=color:#a6e22e>corev1</span>.<span style=color:#a6e22e>ServicePort</span>{
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>Name</span>:       <span style=color:#e6db74>&#34;http&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>Port</span>:       <span style=color:#ae81ff>80</span>,
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>TargetPort</span>: <span style=color:#a6e22e>intstr</span>.<span style=color:#a6e22e>FromInt32</span>(<span style=color:#ae81ff>8080</span>),
</span></span><span style=display:flex><span>})
</span></span><span style=display:flex><span><span style=color:#a6e22e>err</span> = <span style=color:#a6e22e>kubernetes</span>.<span style=color:#a6e22e>SetServiceType</span>(<span style=color:#a6e22e>svc</span>, <span style=color:#a6e22e>corev1</span>.<span style=color:#a6e22e>ServiceTypeLoadBalancer</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// Update metadata</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>err</span> = <span style=color:#a6e22e>kubernetes</span>.<span style=color:#a6e22e>AddServiceLabel</span>(<span style=color:#a6e22e>svc</span>, <span style=color:#e6db74>&#34;env&#34;</span>, <span style=color:#e6db74>&#34;prod&#34;</span>)
</span></span><span style=display:flex><span><span style=color:#a6e22e>err</span> = <span style=color:#a6e22e>kubernetes</span>.<span style=color:#a6e22e>AddServiceAnnotation</span>(<span style=color:#a6e22e>svc</span>, <span style=color:#e6db74>&#34;external-dns.alpha.kubernetes.io/hostname&#34;</span>, <span style=color:#e6db74>&#34;app.example.com&#34;</span>)</span></span></code></pre></div><h2 id=ingress-builders>Ingress Builders</h2><div class="highlight wrap-code" dir=auto><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#75715e>// Create an Ingress</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>ing</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>kubernetes</span>.<span style=color:#a6e22e>CreateIngress</span>(<span style=color:#e6db74>&#34;my-app&#34;</span>, <span style=color:#e6db74>&#34;default&#34;</span>, <span style=color:#e6db74>&#34;nginx&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// Build a rule with paths</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>rule</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>kubernetes</span>.<span style=color:#a6e22e>CreateIngressRule</span>(<span style=color:#e6db74>&#34;app.example.com&#34;</span>)
</span></span><span style=display:flex><span><span style=color:#a6e22e>pt</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>netv1</span>.<span style=color:#a6e22e>PathTypePrefix</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>path</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>kubernetes</span>.<span style=color:#a6e22e>CreateIngressPath</span>(<span style=color:#e6db74>&#34;/&#34;</span>, <span style=color:#f92672>&amp;</span><span style=color:#a6e22e>pt</span>, <span style=color:#e6db74>&#34;my-app&#34;</span>, <span style=color:#e6db74>&#34;http&#34;</span>)
</span></span><span style=display:flex><span><span style=color:#a6e22e>kubernetes</span>.<span style=color:#a6e22e>AddIngressRulePath</span>(<span style=color:#a6e22e>rule</span>, <span style=color:#a6e22e>path</span>)
</span></span><span style=display:flex><span><span style=color:#a6e22e>err</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>kubernetes</span>.<span style=color:#a6e22e>AddIngressRule</span>(<span style=color:#a6e22e>ing</span>, <span style=color:#a6e22e>rule</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// Add TLS</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>err</span> = <span style=color:#a6e22e>kubernetes</span>.<span style=color:#a6e22e>AddIngressTLS</span>(<span style=color:#a6e22e>ing</span>, <span style=color:#a6e22e>netv1</span>.<span style=color:#a6e22e>IngressTLS</span>{
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>Hosts</span>:      []<span style=color:#66d9ef>string</span>{<span style=color:#e6db74>&#34;app.example.com&#34;</span>},
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>SecretName</span>: <span style=color:#e6db74>&#34;my-app-tls&#34;</span>,
</span></span><span style=display:flex><span>})</span></span></code></pre></div><h2 id=related-packages>Related Packages</h2><ul><li><a href=/api-reference/fluxcd-builders/>fluxcd</a>
- FluxCD resource constructors</li><li><a href=../errors/>errors</a>
- Structured error types used for nil-check sentinels</li></ul><footer class=footline></footer></article></div></main></div><aside id=R-sidebar class=default-animation><div id=R-header-topbar class=default-animation></div><div id=R-header-wrapper class=default-animation><div id=R-header class=default-animation><a href=https://www.gokure.dev/ style=text-decoration:none><h1 style=margin:0;padding:1rem;color:var(--MENU-SECTIONS-ACTIVE-BG-color)>Go Kure</h1></a></div><search><form action=/search/index.html method=get><div class="searchbox default-animation"><button class=search-detail type=submit title="Search (CTRL+ALT+f)"><i class="fas fa-search"></i></button>
<label class=a11y-only for=R-search-by>Search</label>
<input data-search-input id=R-search-by name=search-by class=search-by type=search placeholder=Search...>
<button class=search-clear type=button data-search-clear title="Clear search"><i class="fas fa-times" title="Clear search"></i></button></div></form></search></div><div id=R-homelinks class="default-animation homelinks"><div class="R-menu-divider default-animation"><hr class=padding></div><div class="R-sidebarmenu R-shortcutmenu-homelinks"><ul class="space collapsible-menu"><li data-nav-id=/index.html><a class=padding href=/index.html><i class="fa-fw fas fa-home"></i> Home</a></li></ul></div><div class="R-menu-divider default-animation"><hr class=padding></div><div class="R-sidebarmenu R-shortcutmenu-headercontrols"><ul></ul></div><div class="R-menu-divider default-animation"><hr class=padding></div></div><div id=R-content-wrapper class=highlightable><div class="R-sidebarmenu R-shortcutmenu-main"><ul class="enlarge morespace collapsible-menu"><li data-nav-id=/getting-started/index.html><a class=padding href=/getting-started/index.html>Getting Started</a><ul id=R-subsections-87c0363912f379e0725cbe1d504c985c class=collapsible-menu></ul></li><li data-nav-id=/concepts/index.html><a class=padding href=/concepts/index.html>Concepts</a><ul id=R-subsections-90941c33b457a4d12ffdbc0aa62a266d class=collapsible-menu></ul></li><li data-nav-id=/guides/index.html><a class=padding href=/guides/index.html>Guides</a><ul id=R-subsections-8fc2fd7736125e87cab8840a86c2af5a class=collapsible-menu></ul></li><li data-nav-id=/examples/index.html><a class=padding href=/examples/index.html>Examples</a><ul id=R-subsections-2e4187ca04853a7e1382c8d86f7be6fd class=collapsible-menu></ul></li><li data-nav-id=/cli-reference/index.html><a class=padding href=/cli-reference/index.html>CLI Reference</a></li><li class=parent data-nav-id=/api-reference/index.html><a class=padding href=/api-reference/index.html>API Reference</a><ul id=R-subsections-dd202aa4390a9811c67d06158c5ff213 class=collapsible-menu><li data-nav-id=/api-reference/stack/index.html><a class=padding href=/api-reference/stack/index.html>Stack</a></li><li data-nav-id=/api-reference/flux-engine/index.html><a class=padding href=/api-reference/flux-engine/index.html>Flux Engine</a></li><li data-nav-id=/api-reference/generators/index.html><a class=padding href=/api-reference/generators/index.html>Generators</a></li><li data-nav-id=/api-reference/layout/index.html><a class=padding href=/api-reference/layout/index.html>Layout Engine</a></li><li data-nav-id=/api-reference/launcher/index.html><a class=padding href=/api-reference/launcher/index.html>Launcher</a></li><li data-nav-id=/api-reference/patch/index.html><a class=padding href=/api-reference/patch/index.html>Patch</a></li><li data-nav-id=/api-reference/io/index.html><a class=padding href=/api-reference/io/index.html>IO</a></li><li data-nav-id=/api-reference/errors/index.html><a class=padding href=/api-reference/errors/index.html>Errors</a></li><li data-nav-id=/api-reference/cli/index.html><a class=padding href=/api-reference/cli/index.html>CLI Utilities</a></li><li class=active data-nav-id=/api-reference/kubernetes-builders/index.html><a class=padding href=/api-reference/kubernetes-builders/index.html>Kubernetes Builders</a></li><li data-nav-id=/api-reference/fluxcd-builders/index.html><a class=padding href=/api-reference/fluxcd-builders/index.html>FluxCD Builders</a></li><li data-nav-id=/api-reference/logger/index.html><a class=padding href=/api-reference/logger/index.html>Logger</a></li><li data-nav-id=/api-reference/compatibility/index.html><a class=padding href=/api-reference/compatibility/index.html>Compatibility Matrix</a></li></ul></li><li data-nav-id=/changelog/index.html><a class=padding href=/changelog/index.html>Changelog</a><ul id=R-subsections-d1977150cf385e06b32490e43a8e612b class=collapsible-menu></ul></li><li data-nav-id=/contributing/index.html><a class=padding href=/contributing/index.html>Contributing</a><ul id=R-subsections-0d02badb7422c7536b9ac4528048a4b1 class=collapsible-menu></ul></li></ul></div><div class="R-sidebarmenu R-shortcutmenu-shortcuts"><ul class="space collapsible-menu"></ul></div><div id=R-footer-margin></div><div class="R-menu-divider default-animation"><hr class=padding></div><div class="R-sidebarmenu R-shortcutmenu-footercontrols"><ul></ul></div><div id=R-footer></div></div></aside><script src=/js/clipboard/clipboard.min.js?1771438027 defer></script><script src=/js/perfect-scrollbar/perfect-scrollbar.min.js?1771438027 defer></script><script src=/js/theme.min.js?1771438027 defer></script></body></html>